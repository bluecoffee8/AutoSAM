/home/kl321/AutoSAM/scripts/main_feat_seg.py:115: UserWarning: You have chosen a specific GPU. This will completely disable data parallelism.
  warnings.warn('You have chosen a specific GPU. This will completely '
Use GPU: 0 for training
loaded keys: ['image_encoder.neck.0.weight', 'image_encoder.neck.1.weight', 'image_encoder.neck.1.bias', 'image_encoder.neck.2.weight', 'image_encoder.neck.3.weight', 'image_encoder.neck.3.bias', 'image_encoder.patch_embed.proj.weight', 'image_encoder.patch_embed.proj.bias', 'image_encoder.blocks.0.norm1.weight', 'image_encoder.blocks.0.norm1.bias', 'image_encoder.blocks.0.attn.rel_pos_h', 'image_encoder.blocks.0.attn.rel_pos_w', 'image_encoder.blocks.0.attn.qkv.weight', 'image_encoder.blocks.0.attn.qkv.bias', 'image_encoder.blocks.0.attn.proj.weight', 'image_encoder.blocks.0.attn.proj.bias', 'image_encoder.blocks.0.norm2.weight', 'image_encoder.blocks.0.norm2.bias', 'image_encoder.blocks.0.mlp.lin1.weight', 'image_encoder.blocks.0.mlp.lin1.bias', 'image_encoder.blocks.0.mlp.lin2.weight', 'image_encoder.blocks.0.mlp.lin2.bias', 'image_encoder.blocks.1.norm1.weight', 'image_encoder.blocks.1.norm1.bias', 'image_encoder.blocks.1.attn.rel_pos_h', 'image_encoder.blocks.1.attn.rel_pos_w', 'image_encoder.blocks.1.attn.qkv.weight', 'image_encoder.blocks.1.attn.qkv.bias', 'image_encoder.blocks.1.attn.proj.weight', 'image_encoder.blocks.1.attn.proj.bias', 'image_encoder.blocks.1.norm2.weight', 'image_encoder.blocks.1.norm2.bias', 'image_encoder.blocks.1.mlp.lin1.weight', 'image_encoder.blocks.1.mlp.lin1.bias', 'image_encoder.blocks.1.mlp.lin2.weight', 'image_encoder.blocks.1.mlp.lin2.bias', 'image_encoder.blocks.2.norm1.weight', 'image_encoder.blocks.2.norm1.bias', 'image_encoder.blocks.2.attn.rel_pos_h', 'image_encoder.blocks.2.attn.rel_pos_w', 'image_encoder.blocks.2.attn.qkv.weight', 'image_encoder.blocks.2.attn.qkv.bias', 'image_encoder.blocks.2.attn.proj.weight', 'image_encoder.blocks.2.attn.proj.bias', 'image_encoder.blocks.2.norm2.weight', 'image_encoder.blocks.2.norm2.bias', 'image_encoder.blocks.2.mlp.lin1.weight', 'image_encoder.blocks.2.mlp.lin1.bias', 'image_encoder.blocks.2.mlp.lin2.weight', 'image_encoder.blocks.2.mlp.lin2.bias', 'image_encoder.blocks.3.norm1.weight', 'image_encoder.blocks.3.norm1.bias', 'image_encoder.blocks.3.attn.rel_pos_h', 'image_encoder.blocks.3.attn.rel_pos_w', 'image_encoder.blocks.3.attn.qkv.weight', 'image_encoder.blocks.3.attn.qkv.bias', 'image_encoder.blocks.3.attn.proj.weight', 'image_encoder.blocks.3.attn.proj.bias', 'image_encoder.blocks.3.norm2.weight', 'image_encoder.blocks.3.norm2.bias', 'image_encoder.blocks.3.mlp.lin1.weight', 'image_encoder.blocks.3.mlp.lin1.bias', 'image_encoder.blocks.3.mlp.lin2.weight', 'image_encoder.blocks.3.mlp.lin2.bias', 'image_encoder.blocks.4.norm1.weight', 'image_encoder.blocks.4.norm1.bias', 'image_encoder.blocks.4.attn.rel_pos_h', 'image_encoder.blocks.4.attn.rel_pos_w', 'image_encoder.blocks.4.attn.qkv.weight', 'image_encoder.blocks.4.attn.qkv.bias', 'image_encoder.blocks.4.attn.proj.weight', 'image_encoder.blocks.4.attn.proj.bias', 'image_encoder.blocks.4.norm2.weight', 'image_encoder.blocks.4.norm2.bias', 'image_encoder.blocks.4.mlp.lin1.weight', 'image_encoder.blocks.4.mlp.lin1.bias', 'image_encoder.blocks.4.mlp.lin2.weight', 'image_encoder.blocks.4.mlp.lin2.bias', 'image_encoder.blocks.5.norm1.weight', 'image_encoder.blocks.5.norm1.bias', 'image_encoder.blocks.5.attn.rel_pos_h', 'image_encoder.blocks.5.attn.rel_pos_w', 'image_encoder.blocks.5.attn.qkv.weight', 'image_encoder.blocks.5.attn.qkv.bias', 'image_encoder.blocks.5.attn.proj.weight', 'image_encoder.blocks.5.attn.proj.bias', 'image_encoder.blocks.5.norm2.weight', 'image_encoder.blocks.5.norm2.bias', 'image_encoder.blocks.5.mlp.lin1.weight', 'image_encoder.blocks.5.mlp.lin1.bias', 'image_encoder.blocks.5.mlp.lin2.weight', 'image_encoder.blocks.5.mlp.lin2.bias', 'image_encoder.blocks.6.norm1.weight', 'image_encoder.blocks.6.norm1.bias', 'image_encoder.blocks.6.attn.rel_pos_h', 'image_encoder.blocks.6.attn.rel_pos_w', 'image_encoder.blocks.6.attn.qkv.weight', 'image_encoder.blocks.6.attn.qkv.bias', 'image_encoder.blocks.6.attn.proj.weight', 'image_encoder.blocks.6.attn.proj.bias', 'image_encoder.blocks.6.norm2.weight', 'image_encoder.blocks.6.norm2.bias', 'image_encoder.blocks.6.mlp.lin1.weight', 'image_encoder.blocks.6.mlp.lin1.bias', 'image_encoder.blocks.6.mlp.lin2.weight', 'image_encoder.blocks.6.mlp.lin2.bias', 'image_encoder.blocks.7.norm1.weight', 'image_encoder.blocks.7.norm1.bias', 'image_encoder.blocks.7.attn.rel_pos_h', 'image_encoder.blocks.7.attn.rel_pos_w', 'image_encoder.blocks.7.attn.qkv.weight', 'image_encoder.blocks.7.attn.qkv.bias', 'image_encoder.blocks.7.attn.proj.weight', 'image_encoder.blocks.7.attn.proj.bias', 'image_encoder.blocks.7.norm2.weight', 'image_encoder.blocks.7.norm2.bias', 'image_encoder.blocks.7.mlp.lin1.weight', 'image_encoder.blocks.7.mlp.lin1.bias', 'image_encoder.blocks.7.mlp.lin2.weight', 'image_encoder.blocks.7.mlp.lin2.bias', 'image_encoder.blocks.8.norm1.weight', 'image_encoder.blocks.8.norm1.bias', 'image_encoder.blocks.8.attn.rel_pos_h', 'image_encoder.blocks.8.attn.rel_pos_w', 'image_encoder.blocks.8.attn.qkv.weight', 'image_encoder.blocks.8.attn.qkv.bias', 'image_encoder.blocks.8.attn.proj.weight', 'image_encoder.blocks.8.attn.proj.bias', 'image_encoder.blocks.8.norm2.weight', 'image_encoder.blocks.8.norm2.bias', 'image_encoder.blocks.8.mlp.lin1.weight', 'image_encoder.blocks.8.mlp.lin1.bias', 'image_encoder.blocks.8.mlp.lin2.weight', 'image_encoder.blocks.8.mlp.lin2.bias', 'image_encoder.blocks.9.norm1.weight', 'image_encoder.blocks.9.norm1.bias', 'image_encoder.blocks.9.attn.rel_pos_h', 'image_encoder.blocks.9.attn.rel_pos_w', 'image_encoder.blocks.9.attn.qkv.weight', 'image_encoder.blocks.9.attn.qkv.bias', 'image_encoder.blocks.9.attn.proj.weight', 'image_encoder.blocks.9.attn.proj.bias', 'image_encoder.blocks.9.norm2.weight', 'image_encoder.blocks.9.norm2.bias', 'image_encoder.blocks.9.mlp.lin1.weight', 'image_encoder.blocks.9.mlp.lin1.bias', 'image_encoder.blocks.9.mlp.lin2.weight', 'image_encoder.blocks.9.mlp.lin2.bias', 'image_encoder.blocks.10.norm1.weight', 'image_encoder.blocks.10.norm1.bias', 'image_encoder.blocks.10.attn.rel_pos_h', 'image_encoder.blocks.10.attn.rel_pos_w', 'image_encoder.blocks.10.attn.qkv.weight', 'image_encoder.blocks.10.attn.qkv.bias', 'image_encoder.blocks.10.attn.proj.weight', 'image_encoder.blocks.10.attn.proj.bias', 'image_encoder.blocks.10.norm2.weight', 'image_encoder.blocks.10.norm2.bias', 'image_encoder.blocks.10.mlp.lin1.weight', 'image_encoder.blocks.10.mlp.lin1.bias', 'image_encoder.blocks.10.mlp.lin2.weight', 'image_encoder.blocks.10.mlp.lin2.bias', 'image_encoder.blocks.11.norm1.weight', 'image_encoder.blocks.11.norm1.bias', 'image_encoder.blocks.11.attn.rel_pos_h', 'image_encoder.blocks.11.attn.rel_pos_w', 'image_encoder.blocks.11.attn.qkv.weight', 'image_encoder.blocks.11.attn.qkv.bias', 'image_encoder.blocks.11.attn.proj.weight', 'image_encoder.blocks.11.attn.proj.bias', 'image_encoder.blocks.11.norm2.weight', 'image_encoder.blocks.11.norm2.bias', 'image_encoder.blocks.11.mlp.lin1.weight', 'image_encoder.blocks.11.mlp.lin1.bias', 'image_encoder.blocks.11.mlp.lin2.weight', 'image_encoder.blocks.11.mlp.lin2.bias', 'image_encoder.pos_embed']
['patient_035']
['patient_057', 'patient_028', 'patient_087', 'patient_061', 'patient_032', 'patient_011', 'patient_078', 'patient_009', 'patient_068', 'patient_021', 'patient_079', 'patient_004', 'patient_089', 'patient_023', 'patient_070']
['patient_014', 'patient_060', 'patient_044', 'patient_036', 'patient_003', 'patient_100', 'patient_065', 'patient_013', 'patient_038', 'patient_093', 'patient_043', 'patient_082', 'patient_031', 'patient_005', 'patient_016']
dataset length: 26
dataset length: 258
dataset length: 296
output_experiment/basic
Train: [0][0/7]	loss 2.3980
VALIDATE
Epoch:  0 Loss: 0.9138
Train: [1][0/7]	loss 1.1885
VALIDATE
Epoch:  1 Loss: 0.9994
Train: [2][0/7]	loss 1.2385
VALIDATE
Epoch:  2 Loss: 0.8302
Train: [3][0/7]	loss 1.2782
VALIDATE
Epoch:  3 Loss: 0.7786
Train: [4][0/7]	loss 1.0899
VALIDATE
Epoch:  4 Loss: 0.7466
Test
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_014
dataset length: 18
(18, 224, 224) (18, 224, 224)
finish saving file: patient_060
dataset length: 18
(18, 224, 224) (18, 224, 224)
finish saving file: patient_044
dataset length: 16
(16, 224, 224) (16, 224, 224)
finish saving file: patient_036
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_003
dataset length: 16
(16, 224, 224) (16, 224, 224)
finish saving file: patient_100
dataset length: 16
(16, 224, 224) (16, 224, 224)
finish saving file: patient_065
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_013
dataset length: 16
(16, 224, 224) (16, 224, 224)
finish saving file: patient_038
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_093
dataset length: 24
(24, 224, 224) (24, 224, 224)
finish saving file: patient_043
dataset length: 32
(32, 224, 224) (32, 224, 224)
finish saving file: patient_082
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_031
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_005
dataset length: 20
(20, 224, 224) (20, 224, 224)
finish saving file: patient_016
patient_003.nii
patient_003.nii
patient_005.nii
patient_005.nii
patient_013.nii
patient_013.nii
patient_014.nii
patient_014.nii
patient_016.nii
patient_016.nii
patient_031.nii
patient_031.nii
patient_036.nii
patient_036.nii
patient_038.nii
patient_038.nii
patient_043.nii
patient_043.nii
patient_044.nii
patient_044.nii
patient_060.nii
patient_060.nii
patient_065.nii
patient_065.nii
patient_082.nii
patient_082.nii
patient_093.nii
patient_093.nii
patient_100.nii
patient_100.nii
done
********************
patient_003.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_003.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_005.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_005.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_013.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_013.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_014.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_014.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_016.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_016.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_031.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_031.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_036.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_036.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_038.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_038.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_043.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_043.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_044.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_044.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_060.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_060.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_065.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_065.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_082.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_082.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_093.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_093.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
patient_100.nii
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
patient_100.nii
Dice_rv: 0.0000
Dice_myo: 0.0000
Dice_lv: 0.0000
hd_rv: 0.0000
hd_myo: 0.0000
hd_lv: 0.0000
********************
********************
Mean_Dice
Dice_rv0.0
Dice_myo0.0
Dice_lv0.0
Mean_HD
HD_rv0.0
HD_myo0.0
HD_lv0.0
********************
avg_hd:0.0
DSC:0.0
HD:0.0
